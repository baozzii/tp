@startuml
!include style.puml
skinparam ArrowFontStyle plain
title Detailed Sequence for ImportCommand Execution

box Logic LOGIC_COLOR_T1
participant "i:ImportCommand" as ImportCommand LOGIC_COLOR
end box

box IO
participant "eR:ExcelReader" as ExcelReader MODEL_COLOR
participant "eP:ExcelParser" as ExcelParser MODEL_COLOR
endbox

box Model MODEL_COLOR_T1
participant "m:Model" as Model MODEL_COLOR
end box

-> ImportCommand : execute(m)
activate ImportCommand

' Create and use ExcelReader
create ExcelReader
ImportCommand -> ExcelReader : readExcelFile(filePath)
activate ExcelReader

' Create and use ExcelParser
create ExcelParser
ExcelReader -> ExcelParser : parseRows(workbook)
activate ExcelParser

ExcelParser --> ExcelReader : List<Person>
deactivate ExcelParser
destroy ExcelParser

ExcelReader --> ImportCommand : List<Person>
deactivate ExcelReader
destroy ExcelReader

ImportCommand -> Model : addPerson(person)
activate Model

loop for each person
    Model -> Model : validate and add
end

ImportCommand -> Model : saveAddressBook()
Model --> ImportCommand : success
deactivate Model

[<--ImportCommand
deactivate ImportCommand

@enduml
